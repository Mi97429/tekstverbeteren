import { useState } from "react";

const sentences = [
  {
    text: ["J’", "avant de sortir."],
    answers: ["avais", "mangé"],
    explanation: "Correct! Eerst had ik gegeten (avais mangé), daarna ging ik naar buiten."
  },
  {
    text: ["Elle", "quand je suis arrivé."],
    answers: ["était", "partie"],
    explanation: "Correct! Zij was al vertrokken (était partie) toen ik aankwam."
  },
  {
    text: ["Nous", "nos devoirs avant le dîner."],
    answers: ["avions", "fini"],
    explanation: "Correct! Wij hadden onze huiswerk al afgemaakt (avions fini) voor het diner."
  }
];

export default function PlusQueParfaitExercise() {
  const [inputs, setInputs] = useState(sentences.map(s => Array(s.answers.length).fill("")));
  const [score, setScore] = useState(0);

  const handleChange = (sentenceIdx, wordIdx, value) => {
    const newInputs = [...inputs];
    newInputs[sentenceIdx][wordIdx] = value;
    setInputs(newInputs);

    // Bereken score live
    let correctCount = 0;
    newInputs.forEach((words, idx) => {
      if(words.every((w, i) => w.toLowerCase().trim() === sentences[idx].answers[i])) correctCount++;
    });
    setScore(correctCount);
  };

  const reset = () => {
    setInputs(sentences.map(s => Array(s.answers.length).fill("")));
    setScore(0);
  };

  return (
    <div className="p-4 max-w-3xl mx-auto">
      <h2 className="text-xl font-bold mb-4">Oefening: Plus-que-parfait</h2>
      <div className="mb-4 font-semibold">Score: {score} / {sentences.length}</div>

      {sentences.map((s, idx) => (
        <div key={idx} className="flex flex-wrap items-center gap-2 mb-3">
          {s.text.slice(0,1).map((part, i) => <span key={i}>{part}</span>)}
          {s.answers.map((_, i) => (
            <input
              key={i}
              className={`border p-1 w-24 ${inputs[idx][i] === s.answers[i] ? 'border-green-500 bg-green-100' : ''}`}
              value={inputs[idx][i]}
              onChange={e => handleChange(idx, i, e.target.value)}
            />
          ))}
          <span>{s.text.slice(1)}</span>
        </div>
      ))}

      <button onClick={reset} className="mt-4 px-3 py-1 bg-gray-300 rounded">Reset</button>
    </div>
  );
}
